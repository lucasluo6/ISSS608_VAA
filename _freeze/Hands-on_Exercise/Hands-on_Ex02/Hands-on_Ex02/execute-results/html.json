{
  "hash": "fc613f06df6844a277f34f0299496149",
  "result": {
    "markdown": "---\ntitle: \"Hands-on Ex02\"\nauthor: \"Lucas Luo\"\ndate: \"Apr 24 2025\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  message: false\n  freeze: true\n---\n\n\n# **2  Beyond ggplot2 Fundamentals**\n\n## **2.1 Overview**\n\nIn this chapter, you will be introduced to several ggplot2 extensions for creating more elegant and effective statistical graphics. By the end of this exercise, you will be able to:\n\n-   control the placement of annotation on a graph by using functions provided in ggrepel package,\n\n-   create professional publication quality figure by using functions provided in ggthemes and hrbrthemes packages,\n\n-   plot composite figure by combining ggplot2 graphs by using patchwork package.\n\n## **2.2 Getting started**\n\n### **2.2.1 Installing and loading the required libraries**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggrepel, patchwork, \n               ggthemes, hrbrthemes,\n               tidyverse) \n```\n:::\n\n\n### **2.2.2 Importing data**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data <- read_csv(\"data/Exam_data.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 322 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): ID, CLASS, GENDER, RACE\ndbl (3): ENGLISH, MATHS, SCIENCE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\nThe categorical attributes are: ID, CLASS, GENDER and RACE. The continuous attributes are: MATHS, ENGLISH and SCIENCE.\n\n## 2.3 Beyond ggplot2 Annotation: ggrepel\n\nOne of the challenge in plotting statistical graph is annotation, especially with large number of data points.\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: ggrepel: 307 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel01-1.png){width=672}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data, aes(x = MATHS, y = ENGLISH)) + geom_point() + geom_smooth(method = \"lm\", size = 0.5) + geom_label_repel(aes(label = ID), size = 2.5) + coord_cartesian(xlim = c(0, 100), ylim = c(0, 100)) + ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n:::\n\n:::\n\n### **2.3.1 Working with ggrepel**\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: ggrepel: 317 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel02-1.png){width=672}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x= MATHS, y=ENGLISH)) + geom_point() + geom_smooth(method=lm, size=0.5) +\\\ngeom_label_repel(aes(label = ID), fontface = \"bold\") + coord_cartesian(xlim=c(0,100), ylim=c(0,100)) + ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n:::\n\n:::\n\n## **2.4 Beyond ggplot2 Themes**\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel03-1.png){width=672}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x = MATHS)) + geom_histogram(bins=20, boundary = 100, color=\"grey25\", fill=\"grey90\") + theme_gray() + ggtitle(\"Distribution of Maths scores\")\n```\n:::\n\n:::\n\n### **2.4.1 Working with ggtheme package**\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel04-1.png){width=672}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x = MATHS)) + geom_histogram(bins=20, boundary = 100, color=\"grey25\", fill=\"grey90\") + ggtitle(\"Distribution of Maths scores\") + theme_economist()\n```\n:::\n\n:::\n\n### **2.4.2 Working with hrbthems package**\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel05-1.png){width=672}\n:::\n:::\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x = MATHS)) + geom_histogram(bins=20, boundary = 100, color=\"grey25\", fill=\"grey90\") + ggtitle(\"Distribution of Maths scores\") + theme_ipsum()\n```\n:::\n\n:::\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel06-1.png){width=672}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x = MATHS)) + geom_histogram(bins=20, boundary = 100, color=\"grey25\", fill=\"grey90\") + ggtitle(\"Distribution of Maths scores\") + theme_ipsum(axis_title_size = 18, base_size = 15, grid = \"Y\")\n```\n:::\n\n:::\n\n## **2.5 Beyond Single Graph**\n::: panel-tabset\n### The plot\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel07-1.png){width=672}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(data=exam_data, aes(x = MATHS)) + geom_histogram(bins=20, boundary = 100, color=\"grey25\", fill=\"grey90\") + coord_cartesian(xlim=c(0,100)) + ggtitle(\"Distribution of Maths scores\")\n```\n:::\n\n:::\n\nNext \n\n::: panel-tabset \n### The plot\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel08-1.png){width=672}\n:::\n:::\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- ggplot(data=exam_data, aes(x = ENGLISH)) + geom_histogram(bins=20, boundary = 100, color=\"grey25\", fill=\"grey90\") + coord_cartesian(xlim=c(0,100)) + ggtitle(\"Distribution of English scores\")\n```\n:::\n\n:::\n\n::: panel-tabset\n### The plot\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel10-1.png){width=672}\n:::\n:::\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\np3 <- ggplot(data=exam_data, aes(x= MATHS, y=ENGLISH)) + geom_point() + geom_smooth(method=lm, size=0.5) +\ncoord_cartesian(xlim=c(0,100), ylim=c(0,100)) + ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n:::\n\n:::\n\n### **2.5.1 Creating Composite Graphics: pathwork methods**\n\nThere are several ggplot2 extension’s functions support the needs to prepare composite figure by combining several graphs such as [`grid.arrange()`](https://cran.r-project.org/web/packages/gridExtra/vignettes/arrangeGrob.html) of **gridExtra** package and [`plot_grid()`](https://wilkelab.org/cowplot/reference/plot_grid.html) of [**cowplot**](https://wilkelab.org/cowplot/index.html) package. In this section, I am going to shared with you an ggplot2 extension called [**patchwork**](https://patchwork.data-imaginist.com/) which is specially designed for combining separate ggplot2 graphs into a single figure.\n\nPatchwork package has a very simple syntax where we can create layouts super easily. Here’s the general syntax that combines:\n\n-   Two-Column Layout using the Plus Sign +.\n\n-   Parenthesis () to create a subplot group.\n\n-   Two-Row Layout using the Division Sign `/`\n\n### **2.5.2 Combining two ggplot2 graphs**\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel11-1.png){width=672}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\np1 + p2\n```\n:::\n\n:::\n\n### **2.5.3 Combining three ggplot2 graphs**\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel12-1.png){width=672}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\n(p1 / p2) | p3\n```\n:::\n\n:::\n\n### **2.5.4 Creating a composite figure with tag**\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel13-1.png){width=672}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\n((p1 / p2) \\| p3) + plot_annotation(tag_levels = 'I')\n```\n:::\n\n:::\n\n### **2.5.5 Creating figure with insert**\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel14-1.png){width=672}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\np3 + inset_element(p2, left = 0.02, bottom = 0.7, right = 0.5, top = 1)\n```\n:::\n\n:::\n\n### **2.5.6 Creating a composite figure by using patchwork and ggtheme**\n\n::: panel-tabset\n### The plot\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/plot-ggrepel15-1.png){width=1248}\n:::\n:::\n\n\n### The code\n\n::: {.cell}\n\n```{.r .cell-code}\npatchwork \\<- (p1 / p2) \\| p3 patchwork & theme_economist()\n```\n:::\n\n:::\n",
    "supporting": [
      "Hands-on_Ex02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}